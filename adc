/* USER CODE BEGIN PV */
extern ADC_HandleTypeDef hadc1;  // ADC1 handle, generated by CubeMX

uint32_t adc_raw = 0;            // Store raw ADC value
float    adc_voltage = 0.0f;     // Store converted voltage
/* USER CODE END PV */
/* USER CODE BEGIN WHILE */
while (1)
{
    // Start ADC conversion
    HAL_ADC_Start(&hadc1);

    // Wait for conversion to complete
    if (HAL_ADC_PollForConversion(&hadc1, 10) == HAL_OK)
    {
        // Get raw ADC value
        adc_raw = HAL_ADC_GetValue(&hadc1);

        // Convert to voltage (assuming 12-bit ADC, Vref = 3.3V)
        adc_voltage = (float)adc_raw * 3.3f / 4095.0f;
    }

    HAL_ADC_Stop(&hadc1);  // Stop ADC

    // Here you can send adc_raw or adc_voltage via UART for debugging

    HAL_Delay(10);         // Small delay
}
/* USER CODE END WHILE */
